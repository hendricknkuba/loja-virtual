<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Product Detail - RedStore</title>
</head>
<body>
<header class="">
    <div class="container">
        <div class="navbar">
            <div class="logo">
                <img src="img/logo.png" alt="Logo Image" width="125px">
            </div>

            <nav>
                <ul id="MenuItems">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="index.html">Products</a></li>
                    <li><a href="#">About</a></li>
                    <li><a href="#">Contact</a></li>
                    <li><a href="#">Account</a></li>
                </ul>
            </nav>

            <div class="cart-icon-container">
                <a href="cart.html">
                    <img src="img/cart.png" id="cart" alt="Cart" width="30px" height="30px">
                    <span class="cart-counter" id="cartCounter"></span>
                </a>
            </div>
            <img src="img/menu.png" alt="Cart" class="menu-icon" onclick="menuToggle()">
        </div>

    </div>
</header>

<main>

    <!-----Single Product Details----->
    <div class="small-container single-product" id="single-product">

    </div>

    <div class="small-container">
        <div class="row">

        </div>
    </div>

    <div class="small-container">
        <div class="product-container">
            <!-- Detalhes do produto -->
            <div class="product-info">
                <h1 id="product-name">Nome do Produto</h1>
                <div class="product-rating">
                    <div class="average-rating">★★★★★</div>
                    <span class="rating-count">(0 avaliações)</span>
                </div>
                <!-- Outros detalhes do produto -->
            </div>

            <!-- Formulário de avaliação -->
            <div class="review-form">
                <h3>Deixe sua avaliação</h3>
                <form id="reviewForm">
                    <div class="star-rating">
                        <span class="star" data-value="1">★</span>
                        <span class="star" data-value="2">★</span>
                        <span class="star" data-value="3">★</span>
                        <span class="star" data-value="4">★</span>
                        <span class="star" data-value="5">★</span>
                        <input type="hidden" id="ratingValue" name="rating" value="0">
                    </div>
                    <div class="form-group">
                        <label for="reviewText">Seu comentário:</label>
                        <textarea id="reviewText" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="reviewerName">Seu nome:</label>
                        <input type="text" id="reviewerName" required>
                    </div>
                    <button type="submit">Enviar Avaliação</button>
                </form>
            </div>

            <!-- Lista de avaliações -->
            <div class="reviews-section">
                <h3>Avaliações dos Clientes</h3>
                <div id="reviewsList" class="reviews-list">
                    <!-- As avaliações serão inseridas aqui via JavaScript -->
                </div>
            </div>
        </div>
    </div>
</main>

<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="footer-col-1">
                <h3>Download Our App</h3>
                <p>Download App for Android and IOS apps</p>
                <div class="app-logo">
                    <img src="img/play-store.png" alt="App Logo">
                    <img src="img/app-store.png" alt="App Logo">
                </div>
            </div>

            <div class="footer-col-2">
                <img src="img/logo-white.png" alt="">
                <p>Our Purpose Is To Sustainable Make the Pleasure and Benefits of Sports Accessible to the Many.</p>
            </div>

            <div class="footer-col-3">
                <h3>Useful Links</h3>
                <ul>
                    <li>Coupons</li>
                    <li>Blog Post</li>
                    <li>Return Policy</li>
                    <li>Join Affiliate</li>
                </ul>
            </div>

            <div class="footer-col-4">
                <h3>Follow Us</h3>
                <ul>
                    <li>Facebook</li>
                    <li>X</li>
                    <li>Instagram</li>
                    <li>Youtube</li>
                </ul>
            </div>
        </div>
        <hr>
        <p class="copyright">&copy; Copyrights Red Store. All Rights Reserved.</p>
    </div>
</footer>
<script>
    //Toggle menu
    var menuItems = document.querySelector('#MenuItems');
    console.log(menuItems);
    menuItems.style.maxHeight = '0px';

    let isDisabled = true;

    function menuToggle(){
        if (menuItems.style.maxHeight === "0px"){
            menuItems.style.maxHeight = "200px";
        }else {
            menuItems.style.maxHeight = "0px";
        }
    }

    function displayProductDetail()
    {
        let container = document.getElementById('single-product');
        const productDiv = document.createElement('div');

        productDiv.className = 'row';

        productDiv.innerHTML = `
            <div class="col-2">
                <img src="img/404.jpg" width="100%" id="productImg" alt=""/>
            </div>

            <div class="col-2">
                <p>Home / Product Detail</p>
                <h1 id="product-name">Nothing to show</h1>
                <h4 id="product-price">$0.00</h4>
                <label for="quantity">Quantity:</label>
                <div id="quantity"></div>
                <button class="btn" onclick="addProductToCart()">Add To Cart</button>
                <p id="stock">Left in Stock: </p>
                <h3>Description <i class="fa fa-ident"></i></h3>
                <br>
                <p>
                   Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam metus turpis, commodo at sapien sit amet, gravida fermentum ex. Duis sollicitudin eros orci, gravida viverra nibh posuere in. Curabitur nec leo massa.
                </p>
            </div>
        `;

        container.appendChild(productDiv);
    }

    function productDetail()
    {
        const productId = localStorage.getItem('selectedProductId');
        const allProducts = JSON.parse(localStorage.getItem('convertedProducts')) || [];
        const preferredCurrency = localStorage.getItem('preferredCurrency');
        const currency = displayCurrency(preferredCurrency);

        if (productId) {
            const product = allProducts.find(p => p.id == productId);
            console.log(product);
            isDisabled = false;
            console.log(
                isDisabled
            )
            if (product) {
                // Aqui você popula a página com os dados do produto
                document.getElementById('product-name').textContent = product.name;
                document.getElementById('productImg').src = product.img;
                document.getElementById('product-price').textContent = `${currency}${product.price.toFixed(2)}`;
                document.getElementById('stock').textContent = `Left in Stock: ${product.stock}`;

                const inputDiv = document.getElementById('quantity');
                inputDiv.innerHTML = '';
                const input = document.createElement('input');
                input.type = 'number';
                input.className = 'input-quantity';
                input.value = 1;
                input.min = 1;
                input.max = product.stock;
                input.style = 'width: 80px;';
                input.id = 'product-quantity';
                // ... e por aí vai

                inputDiv.appendChild(input);
            } else {
                alert("Product not found!");
            }
        }
    }

    function addProductToCart()
    {
        let quantity = document.getElementById('product-quantity').value;
        const productId = localStorage.getItem('selectedProductId');
        console.log(quantity);
        addToCart(productId, quantity);
    }

    window.addEventListener('DOMContentLoaded', function() {
        displayProductDetail();
        productDetail();
    });
</script>
<script src="js/script.js"></script>
<script src="js/reviews.js"></script>
</body>
</html>